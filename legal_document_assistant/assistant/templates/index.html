{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Legal Advisor</title>
    {% tailwind_css %}
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}">

</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-full min-h-screen mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold text-center mb-4">Legal Document Assistant</h1>

        <!-- Chat History -->
        <div id="chatHistory" class="chat-history overflow-y-auto max-h-screen mb-4">
            {% for message in conversation %}
                <div class="mb-4">
                    {% if message.role == "user" %}
                        <!-- User Query -->
                        <div class="bg-blue-100 p-3 rounded-lg text-gray-800">
                            <strong>User:</strong> {{ message.content }}
                        </div>
                    {% elif message.role == "assistant" %}
                        <!-- Assistant Response -->
                        <div class="bg-gray-100 p-3 rounded-lg text-gray-800 mt-2">
                            <strong>Assistant:</strong>
                            <div class="prose max-w-none space-y-2">
                                {{ message.content|safe }}
                            </div>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>

        <!-- Loader -->
        <div id="loader" class="loader"></div>
        
        <!-- Query Form -->
        <form id="chatForm" method="POST">
            {% csrf_token %}
            <div>
                <textarea id="queryInput" name="query" class="w-full p-3 border rounded-lg mb-4" placeholder="Ask a legal question..." required></textarea>
                <button type="submit" class="w-full bg-blue-500 text-white p-3 rounded-lg">Submit</button>
            </div>
        </form>
        <!-- Button to end session -->
        <form action="{% url 'end_session' %}" method="get">
            <button type="submit" class="bg-red-500 text-white p-2 rounded">End Session</button>
        </form>
    </div>
    <script src="../static/script.js"></script>
</body>
</html>
